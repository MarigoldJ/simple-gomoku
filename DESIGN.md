# 오목 웹앱 설계 (Vanilla HTML/CSS/JS)

## 목표
- 순수 HTML/CSS/JS만으로 동작하는 가벼운 오목 사이트를 제작하고 GitHub Pages로 배포한다.
- 빌드/런타임 의존성을 제거해 접근성을 높이고, 데모·가벼운 플레이에 적합한 단일 페이지를 제공한다.

## 범위와 기능
- 기본 규칙: 15x15(또는 19x19 선택) 보드, 흑 선공, 연속 5목 승리.
- 옵션: 금수(33, 44, 6목) ON/OFF, AI 난이도 선택, 보드 크기 선택.
- 모드: 로컬 2인, AI 대국(간단 랜덤→휴리스틱/미니맥스 depth 2-3).
- UX: 돌 놓기, 언두, 리셋, 마지막 착수 하이라이트, 좌표 표시, 터치 지원.
- 상태/표시: 턴 표시, 승패/무효 메시지, 옵션 모달, 공유용 링크(쿼리 기반) 복사.

## 기술 스택
- HTML + CSS + JS (ES 모듈)만 사용, 빌드 없음.
- Canvas 렌더(고정 크기 레이어 하나)로 보드/돌/하이라이트 표현.
- 브라우저 저장/URL 쿼리로 옵션 로드, 외부 라이브러리 최소화.

## 파일 구조(안)
- `index.html` : 엔트리, 마크업, 모달/컨트롤 영역.
- `styles.css` : 색/폰트 변수, 레이아웃, 반응형.
- `main.js` : 초기화, 이벤트 바인딩, 옵션 로드/저장.
- `lib/game.js` : 상태 구조, 착수/언두/리셋, 승패·금수 판정.
- `lib/render.js` : 캔버스 초기화, DPR 스케일, 클릭→좌표 매핑, 그리기.
- `lib/state.js` : 전역 상태/옵션 관리, 간단한 구독/알림 함수.
- `lib/ai.js` : 랜덤 AI, 필요시 휴리스틱/미니맥스(depth 2-3) 확장.
- `assets/` : 파비콘 등 정적 자산.
- `tests/`(선택) : 브라우저에서 Mocha+Chai CDN으로 로직 단위 테스트 실행.

## 상태 및 렌더 설계
- 상태: `board`(1D 배열), `size`, `currentPlayer`, `history`(스택), `forbiddenEnabled`, `aiLevel`, `mode`, `winner`.
- 흐름: 입력(클릭/터치) → 좌표 변환 → `game.place()` → 상태 업데이트 → `render.draw(state)` 호출.
- 렌더: DPR 기준으로 캔버스 크기 보정, 격자/좌표/돌/하이라이트 레이어 그리기, 리사이즈 시 재계산.

## 게임 로직
- 보드 표현: 1D 배열 길이 `size*size`, 인덱스 `y*size + x`.
- 착수/언두: `history`에 move/캡처 상태 push, 언두 시 pop 후 렌더.
- 승리 판정: 네 방향(가로/세로/두 대각) 연속 카운트; 마지막 착수 기반 검증.
- 금수 판정(선택): 33/44/6목 체크 함수로 흑 착수 시 유효성 검사, 옵션 OFF이면 스킵.

## AI (단계적)
- Lv1: 랜덤 합법 착수.
- Lv2: 휴리스틱 점수(열린3/4, 막힌4, 즉시승/방어)로 그리디 선택.
- Lv3(선택): 깊이 2-3 미니맥스 + 단순 알파베타, 후보군은 상하좌우 2~3칸 내 제한.

## 접근성/국제화
- 포커스 가능한 버튼/슬라이더, 키보드(Enter/Space)로 착수 옵션, ARIA 라벨 제공.
- 색 대비 확보, 색상 변수 정의로 테마 조정 용이.
- 문자열 분리 후 한/영 토글 가능하게 설계(필요시).

## 테스트
- `lib/game.js` 승리/금수/언두 단위 테스트를 브라우저 러너로 구성(Mocha+Chai CDN).
- 금수 ON/OFF, 다양한 보드 크기에서의 착수 유효성 케이스 포함.

## GitHub Pages 배포
- Pages 소스: `docs/` 디렉터리(또는 `gh-pages` 브랜치) 선택.
- 빌드 없음: 최종 HTML/CSS/JS/자산을 해당 위치에 복사 후 푸시.
- 커스텀 도메인 사용 시 `docs/CNAME` 추가.

### 배포 절차 (예시: docs 사용)
1) `docs/` 디렉터리를 만들고 정적 파일을 복사  
   - `mkdir -p docs && cp index.html styles.css main.js devserver.js README.md docs/`  
   - `cp -r lib docs/` (필요 시 `assets/` 포함)
2) GitHub Pages 설정: 리포 Settings → Pages → Source: `Deploy from a branch` → Branch: `main` / Folder: `/docs`.
3) 저장 후 안내된 URL로 접속. 커스텀 도메인은 `docs/CNAME`에 도메인명 추가 후 다시 푸시.
4) 캐시 무효화를 위해 필요 시 새로고침(또는 쿼리 파라미터) 후 동작 확인.

### 배포 절차 (대안: gh-pages 브랜치)
1) 정적 파일을 `gh-pages` 브랜치 루트에 두고 푸시.
2) Settings → Pages → Source: `Deploy from a branch` → Branch: `gh-pages` / Folder: `/` 선택.
3) 동일하게 URL에서 동작 확인.

## TODO 체크리스트
- [x] 디자인 토큰 결정(배경/라인/돌 색, 폰트, 모바일 보드 크기).
- [x] 게임 로직: 착수/언두/리셋, 승리/금지 수 판정(단순화).
- [x] 렌더: 캔버스 초기화, 좌표 매핑, 마지막 착수 하이라이트, 리사이즈 대응.
- [x] UI: 턴/상태 표시, 리셋/언두/옵션(금지 수/보드 크기/AI).
- [ ] 공유/퍼머링크: 링크 복사, 옵션 쿼리 로드.
- [ ] 접근성/국제화: ARIA/포커스, 키보드 지원, 문자열 분리.
- [ ] AI 고도화: 휴리스틱/미니맥스 depth 2-3.
- [ ] 테스트: 핵심 로직 브라우저 단위 테스트.
- [ ] GitHub Pages 배포: `docs/` 또는 `gh-pages`로 정적 파일 올리기, 필요 시 `CNAME`.
